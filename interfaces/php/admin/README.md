![CASH Music Admin](https://cashmusic.s3.amazonaws.com/permalink/images/readme.jpg)

The CASH admin app is a standalone process that interfaces with the CASH framework. 
All relevant files are located in the repo at /interfaces/php/admin/  

The dev installer will set up the admin app, but for a manual install you need a 
working install of the framework. The RewriteBase value in the admin .htaccess 
file will need to reflect the true web root of the admin, and the $cashmusic_root 
and ADMIN_WWW_BASE_PATH values in constants.php need to point to real framework / 
www locations.  


##Admin App Structure  
The admin app is a little duct-tapey right now, with lots of improvements to the 
PHP to come. All of the heavy lifting is handled in the framework, so the app itself 
is minimal. The .htaccess file routes all requests to a modest front controller 
(controller.php) which parses the incoming URL and turns it into a request. The 
request is then sent to the appropriate script/markup and the result is all pushed 
into the UI template. 

The markup for the core of each page has been separated from the main UI with the 
plan that all forms/pages could be more easily embedded in something like the 
WordPress admin later on. 

Page menus are generated in the main definition file for each section. This is a 
pretty dumb choice, honestly. It'll change. For now, see /definitions/assets.php 
for an example of this dumb choice in practice. 


##Admin Core Classes  
The /interfaces/php/admin/classes folder contains two different classes for working 
with the admin — AdminCore which needs to be instantiated and a static helper class 
called AdminHelper. Both are auto-loaded — an instance of AdminCore is available to 
all scripts as $cash_admin, and AdminHelper is included in the path for 
AdminHelper::function() calls. 


##Admin Url Structure  
Page scripts/markup are stored in /interfaces/php/admin/components/pages — the 
'definitions' directory contains a script for each page to process requests, and 
'markup' stores the guts of the page for rendering the output. Script names follow 
the URL patterns with underscores instead of slashes (/assets/add = assets_add.php) 
— the controller selects the appropriate definition/markup based on the URL and 
POSTS all remaining parts of the URL as postname1/value1/postname2/value2, etc.

CASH framework request responses are passed from the definition to the markup 
using a simple storage method in AdminCore, like so:  
  
```php
$cash_admin->requestAndStore(
	array(
		'cash_request_type' => 'type', 
		'cash_action' => 'action',
		'details' => 'value'\
	),
	'storedresponse'
);

$cash_admin->getStoredResponse('addasset');
```  
  
Any other needed variables will persist in the global scope as we're just using 
includes.  


##What's Next  
 - We're planning to move to mustache templates for all markup so pages can be.  
 - generated by PHP or JS/AJAX with maximum portability. We'll move the JS itself 
   to jQuery (from MooTools.)  
 - Better JS interaction in general.  
 - PHP structure could be improved/streamlined.  
 - OAuth setup of connections, post definition scripts to allow for extra 
   processing (add a list from MailChimp, bring in assets, etc.)  
 - Get rid of the dumb menu definition stuff. It's dumb.

 